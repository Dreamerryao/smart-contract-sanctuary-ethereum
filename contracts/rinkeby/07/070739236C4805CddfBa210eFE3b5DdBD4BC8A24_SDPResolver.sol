/*555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
5555555555555555555555555555555555555555555555555555555555555555555555555555PPPPPP5555555PPPPPPP55555555555555555555555555555555555555555555555555555555555555555555555555555555555555555
5555555555555555555555555555555555555555555555555555555555555555555555PPP55Y?7!~^^:::::::::^~!7JY5PPPP5PPP5555555555555555555555555555555555555555555555555555555555555555555555555555555
5555555555555555555555555555555555555555555555555555555555555555555PP5Y7~:............          ...~!!~^:~Y555555555555555555555555555555555555555555555555555555555555555555555555555555
5555555555555555555555555555555555555555555555555555555555555555PPY?^:.........  .....::^~!7!. .:^~!!^^:~7YPP5555555555555555555555555555555555555555555555555555555555555555555555555555
5555555555555555555555555555555555555555555555555555555555555PP57^........  ..::^^~7?Y55PP5?~~~7?J7:  ....:^75PPPPPPPPP555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555PPY~......... .:^~~~7JY5PPPP5?~~!7????^^?!:...    .~?77!!~^^?P5555555555555555555555555555555555555555555555555555555555555555
5555555555555555555555555555555555555555555555555555555555PJ^........  .^!~~!J5PP55PPY!~~7??77??:!PPPY~...:^~!!!~^~!77J555555555PPP555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555PY^......... .~!^~?5PP555P5J~~!?777!7??.?5?~~~!7??JJ?^.   ~J?77!!!!!!!!777?JY5PP55555P5555555555555555555555555555555555555555555
5555555555555555555555555555555555555555555555555555555P7:7?7^:... .~!^~JPP55PPPPJ~~7777??77??!.!^~7????????: ..:^^!7????????????77!!!!?YYYYYJ5555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555P5^.:^~^^^~~.:7^^JPPPP5Y?7~..7J77????!????77????????????????JJ?????77!!!!~~!!!!!!~~!~^^^~Y555555555555555555555555555555555555555555
5555555555555555555555555555555555555555555555555555PY.......... ~~:7P55J!:.    7#!???????77??777??????????????????77!!!7?JY5GBBGP7777?J!:~7JP5555555555555555555555555555555555555555555
555555555555555555555555555555555555555555555555555PJ..:....... ~:^55JYB.      [email protected]&::!77??????YY7!????777?YY?!77??!!77J5PPPP#&B5J??77!!7???7:~55555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555PY.......... ::[email protected]@~:^.   !5::7#@P!??????5Y77?JJ5PBBPJ????!!7?5PPY?JG#P?77777777?????:?P55555555555555555555555555555555555555555555
555555555555555555555555555555555555555555555555555.......... [email protected]@@@@&J  ^[email protected]@@@@@@&!J??????YYYYPGG5J77????!7?YP5?!?B#P?77!!!7?JY55YJ7?.?P55555555555555555555555555555555555555555555
5555555555555555555555555555555555555555555555555P~ :....... ..?5?&@@@@@J .7#@@&@@@@@@@::7??JJ??JGGPJ7??????7!?JP57!?B&P7!!7?YPGGGPYJ7777?!.?P5555555555555555555555555555555555555555555
555555555555555555555555555555555555555555555555PY ........  .^[email protected]@@@@@@[email protected]@@P^[email protected]@@@@@@.?&@P.:??##J7?77????7!?Y5?!?B&P??5GB#BG5J7777777!~^~7Y55555555555555555555555555555555555555555555
555555555555555555555555555555555555555555555555P:......... ..:..~^[email protected]@@P~JJ7~::~?J#@@@!.~^:   . ^5GGGB5!7?7!?YJ!?#@&BB##G5J77!!!!!~~~~~7JY5P555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555P7 ........  .::::..!#P~::::::^:^[email protected]@&!          75P!~!JBGPGJ?J7?#@@#P5J777!!~~~~!!7?Y55PPP555555555555555555555555555555555555555555555555
5555555555555555555555555555555555555555555555P?.......... ..~^::::...?#~:::^^:[email protected]^  ~Y       [email protected]:  YP  ..7J??YGJ7!!!!~:. .?Y55PPPP555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555P5!........... .::^~::::::[email protected]?J!:::GP^[email protected]&~~~    &P^^J#@&:^:  .!7?777?JJ~^.   .Y555555555555555555555555555555555555555555555555555555555555
5555555555555555555555555555555555555555555P7............   ^^:^~:::^~:[email protected]@P~^J&@@@@@@@@@B^  !&@@@@@@##@B^  !J5BGGGB#&&B!..~?!YYYYYYYYYY!Y555555555555555555555555555555555555555555555555
555555555555555555555555555555555555555555P~  :^~~^.  ...  ~:.^7^~.~~^^:!^:7B&&&&&&&###BJJYP####&&&&##&BB##&&&&&&&&&&&&@@@@@@&&&&&&@@@@7JP55555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555P7 .!?7!7?J7: ... !Y~.!7^~:~.:~.5YB&&&&&&&&&&&&&&&&&&&&&&&@@@@@@@@@&&@@@@@#[email protected]@!J555555555555555555555555555555555555555555555555
555555555555555555555555555555555555555555..?7^^77!~?Y~ .. .JY~:7~^.^..^:!!B&&&&&PJ?7!^^:::::::::^!^[email protected]@@&&@&&@@@@@B.:~!7!?~:!!!777!:.&@~Y555555555555555555555555555555555555555555555555
5555555555555555555555555555555555555555P? ~?^ ~~^?J!7Y^ .. ~JJ^~7::::.:^.~#&&&&!^~~~~~~^^....~JYPG::[email protected]@@&&&&&&@@@Y.::!YP5!557J?!!7^^&@~Y555555555555555555555555555555555555555555555555
5555555555555555555555555555555555555555P7 !?.^:~!:JY7J? .. :5Y7^?^^.:::^.~&&&&#.777??J^^. .:^^^JY7.^#@@@&&#B#&&&@7:^::Y57~PY?!!!!7:[email protected]&^5555555555555555555555555555555555555555555555555
5555555555555555555555555555555555555555P? ~?:^^!7^757?J... .PPY^?^^.:~~^.!&&&&G.~7???!::.~~:..:~7:.~&@@G:   ..B&&~^^:??:..!~~~~~~^^[email protected]&^5555555555555555555555555555555555555555555555555
555555555555555555555555555555555555555555. 77^^~~~Y77J7 .. .PPY~?^^.~~~:^7&&&&Y^?!!!7Y7:^7~....^::^[email protected]@G:JYY5G: &&#7~!7!!77?JY55PGB&@&Y!P555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555PY..7?7~!7!7??. .. ^PP7~7^::~~~..?&&&&G:~!!~^~!^......^^^!Y&@#:#@@@@@# !&&&&&&&&&&&&&###BGPY7?55555555555555555555555555555555555555555555555555
555555555555555555555555555555555555555555P5: :!77777~. .. .5P?~7!^.^~~:^.J&&&&&#5JJYY5PGBB##&&&&&&@&[email protected]@@@@@@#77Y5!?5YJ^.^?????JJJY5P55555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555P?:...... ..  ^55?!7?^:.~~^.~:.G&&&&&&&&&&&&@@&&#BBGP5Y7~Y&&&@@@@@@@@@&5~:..    !PPPPP5555555555555555555555555555555555555555555555555555555
555555555555555555555555555555555555555555555PPY!.  ....:!J?!77?~:.~^:.:^^:..^~?PGP!:::.. .?GGB##&&.  .JB&&@@@@@@@Y  ^?     .7P5555555555555555555555555555555555555555555555555555555555
555555555555555555555555555555555555555555555555P5?^^~!77777??7^.....:Y&~::^:  [email protected]:  !5 .?#@@@@@@@@YJPP5P&@@@@@@@@B5#&@#!  .#^Y5555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555PPY7~^!!!!~:  ?5JJP&@@PYY:   J5:^7PGPG&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&G: 5:7P555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555P5^&&G:  !&@@@@@@@@@#~  ~G#BBBB#&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&J^~!P555555555555555555555555555555555555555555555555555555555
555555555555555555555555555555555555555555555555555555P~B5  !&@@[email protected]@@&&&&~  ^P####&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&B~:?5PPPP5555555555555555555555555555555555555555555555555555
5555555555555555555555555555555555555555555555555555555Y~^!&@@? :@&B####B#&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@B?~~!7JY5PP555555555555555555555555555555555555555555555555
5555555555555555555555555555555555555555555555555555555PJ..:.    .^@@&&&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&&&&&&&&&&@@@@@@@#GY7~^~7YPP555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555PY.      ?B&@&#BPPB&&&&@@@@@@@@@@@@@@@@@@@@@@@@@@@@&&&&&&&&&#BG5J?77?J5G#@@@@&&BJ~:?P55555555555555555555555555555555555555555555
555555555555555555555555555555555555555555555555555555555P5!    ^@[email protected]@@@&PJJP#&&&@@@@@@@@@@@@@@@@@@@@@@@&&&&&&&BPYJ?JJY5PPGGBBBB###&&&@@@B.~P5555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555P5!. !B~~5&&&@@@@#577YB&&@@@@@@@@@@@@@@@@@@@@&&&&#BP5PGB#&&&&&&&&&&&&&&&&&&&&@@@# 7P555555555555555555555555555555555555555555
555[email protected]@@@@&#PB&@@@&P7~7YB&&@@@@@@@@@@@@@@@@@@&##&&&&&&&@@@&&&&######&&&&&&@@@@# 7P555555555555555555555555555555555555555555
555555555555555555555555555555555555555555555555555555555555555P5J?Y#@@@^  5#&&@@@&BY!~!?YGB#&&@@@@@@@@@@@@@@@@@@@@&&BP555PGBBBBBBBBBB#BG5?.~55555555555555555555555555555555555555555555
55555555[email protected]:?&&G: ?##&@@@&#GY?7!!!7J5B&&@@@@@@@@@@@&#PYY5B#&@@@@@@@@@@@@&@7 ~7YP55555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555P5J~ ...     .5BB#&@@@@@@&&#G5J77?5G#&&&&#GY?JG#@@@@@&#BBGGGGB##&&#.:PP5555555555555555555555555555555555555555555555
5555555555555555555555555555555555555555555555555555555555555555555555PP:       [email protected]&Y. .^?5G#&&&@@@@@&#G5YJJJYYPB&@@@&GJ!^^^^~~~~~~^^^^:!5555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555P!      [email protected]  JP       7?~?P#&@@@@@&&@@@@&G?^:^7JY5PPPPPPPPPP55PP5555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555P~~?.   5P~7P&@@?J7    GY~~Y7^7?5GB##BPJ!^^7Y5PPP55555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555P!J~  [email protected]@@@@@@@@@P. [email protected]@@@@@5!5J?7!!!!!?Y5PP5555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555555P!  [email protected]@#[email protected]@@@@@@. [email protected]@G&@@@@P7P5PPPPPPPP55555555555555555555555555555555555555555555555555555555555555555555555555
55555555555[email protected]@#^ [email protected]@@@@@&[email protected]@G. [email protected]@@@57P55555555555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555555555PPPP! .      ^[email protected]@B: ..     .^[email protected]?PPPPP5555555555555555555555555555555555555555555555555555555555555555555555555555555
555555555555555555555555555555555555555555555555555555555555555555P5?~::.       [email protected]@B:         :[email protected]@J .^:~7J5PPP555555555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555555PPYJ~   7&       [email protected]  Y&       [email protected]  .G5     .~?5P5555555555555555555555555555555555555555555555555555555555555555555555555
5555555555555555555555555555555555555555555555555555555555555PJ~!5J?5&@@YJ?.   [email protected]@@JJ?.  [email protected]@&JY!   .YJ?J555555555555555555555555555555555555555555555555555555555555555555555555
555555555555555555555555555555555555555555555555555555555555Y!J&@@@@@@@@@B:  [email protected]@@@@@@@@@P: [email protected]@@@@@@@@@J  :[email protected]@@&57YP555555555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555555J5&@&[email protected]@@@@@@^ [email protected]@[email protected]@@@@@&.  J&@[email protected]@@@@@&  ^#@@5&@@@&J7555555555555555555555555555555555555555555555555555555555555555555555
[email protected]&~ :@@@@@@@^[email protected]@B^ [email protected]@#5?77~7Y55Y!?YYYPG#[email protected]@Y  #@@@@@B~5P555555555555555555555555555555555555555555555555555555555555555555
555555555555555555555555555555555555555555555555555555555^ .      :[email protected]@&^ ..     .^?G&@@@@@@@@@@@@@&#B5J~.     [email protected]@@Y .5P55555555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555555555~        [email protected]@B:         7#@@@@@@@@@@@@@@@@@@@@@@@@#J. !&@&7    .555555555555555555555555555555555555555555555555555555555555555555
555555555555555555555555555555555555555555555555555555P7B^      [email protected]  J&.    [email protected]@@@@@@@@@@@@@@@@@@@@@@@@@@@&#??#~  ^&J  .P5555555555555555555555555555555555555555555555555555555555555555
[email protected]^   Y#[email protected]@@P: !&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@P ^J?7Y#@@#YY^~P555555555555555555555555555555555555555555555555555555555555555
[email protected]@@#~  [email protected]@@@@@@@@?:#@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@[email protected]@@@@@@@&!  YP55555555555555555555555555555555555555555555555555555555555555
[email protected]@?  [email protected]@#[email protected]@@@@#[email protected]@@@@@@@@@@@@@@@@&&@@@@@@@@@@@@@&@@&[email protected]@@@@@G  ?B~P55555555555555555555555555555555555555555555555555555555555555
[email protected]@@~7&@#^ :@@@@[email protected]@@@@@@@@@@@@@@@@@@P&@@@@@@@@@@@@@@&@&J&@@@@J~#@&:J55555555555555555555555555555555555555555555555555555555555555
[email protected]&!         ~G!^&@&&@@@@@@@@@@@@@@@@@@[email protected]@@@@@@@@@@@@@[email protected]@&J      !P5555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555557G^          5G. ~:[email protected]@@@@@@@@@@@@@@@@@PY&@@@@@@@@@@@@@?&@&!        .P5555555555555555555555555555555555555555555555555555555555555
555555555555555555555555555555555555555555555555555Y   !&^      !G    ^@@&[email protected]@@@@@@@@@@@@@@@@@@Y:#@@@@@@@@@@@@&#~  ^&J      ?P555555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555555P!?G&@@B5Y:   [email protected]@@&[email protected]&&&&@@@@@@@@@@Y?JYG#&@@@@@@@@@@@@&7?5&@@#Y5!   :5555555555555555555555555555555555555555555555555555555555555
[email protected]@@@@@B:  [email protected]@@@@@@[email protected]@@&&&@@@@@@@@@@@@@!:Y&@@@@@@@@@@@@@@@@&@@@@@@#!  !&B~P55555555555555555555555555555555555555555555555555555555555
5555555555555555555555555555555555555555555555555P~&@@@@@7 [email protected]&[email protected]@@@@[email protected]@@@@@@@@@@@@@@@@@@@&J:[email protected]@@@@@@@@@@@@@@[email protected]@@@@P  [email protected]@&Y57P5555555555555555555555555555555555555555555555555555555555
[email protected]&@@@@~?&@B^ ^@&&@@[email protected]@@@@@@@@@@@@@@@@@@@@&^!&@@@@@@@@@@@@@&P&@@@@J^#@#!  &J~5555555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555555PY  [email protected]@&~       . ^[email protected]@[email protected]@@@@@@@@@@@@@@@@@@@#?&@@@@@@@@@@@@@@@G [email protected]@&? .       .775P5555555555555555555555555555555555555555555555555555555
5555555555555555555555555555555555555555555555PY. [email protected]@B^          :@@P. &@@@@@@@@@@@@@@@@@@@&@@@@@@@@@@@@@@@@@Y&@#!          [email protected]@5.?5555555555555555555555555555555555555555555555555555555
55555555555555555555555555555555555555555555557  [email protected]:  [email protected]~      ~J7.  Y&@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&G&~  ^B:       @#^  ~75555555555555555555555555555555555555555555555555555*/
// SPDX-License-Identifier: MIT

pragma solidity ^0.8.2;

import "@openzeppelin/contracts/utils/Strings.sol";
import "@openzeppelin/contracts/token/ERC721/IERC721.sol";
import "@ensdomains/ens-contracts/contracts/registry/ENS.sol";

contract DefaultReverseResolver {

	mapping (bytes32 => string) public name;

}

contract SDPResolver {

	using Strings for uint256;
	string public parentLabel = "esperimento"; //mod
	mapping(bytes32 => uint256) public nodeToId;
	ENS constant private ens = ENS(0x00000000000C2E074eC69A0dFb2997BA6C7d2e1e);
	IERC721 constant public nft = IERC721(0x95CA313D4b3d35891857225b687E41B9cD2672Ee); //mod
	bytes32 constant ADDR_REVERSE_NODE = 0x91d1777781884d03a6757a803996e38de2a42967fb37eeaca72729271025a9e2;
	DefaultReverseResolver constant public reverseResolver = DefaultReverseResolver(0x084b1c3C81545d370f3634392De611CaaBFf8148); //mod

	function supportsInterface(bytes4 interfaceID) public pure returns (bool) {
		return interfaceID == 0x3b3b57de || interfaceID == 0x691f3431 || interfaceID == 0x59d1d43c || interfaceID == 0x01ffc9a7;
	}

	function addr(bytes32 node) public view returns (address) {
		return nft.ownerOf(nodeToId[node]);
	}

	function addressToBytes(address a) internal pure returns(bytes memory b) {
		b = new bytes(20);
		assembly {
			mstore(add(b, 32), mul(a, exp(256, 12)))
		}
	}

	function addr(bytes32 node, uint coinType) public view returns(bytes memory) {
		if(coinType == 60){
			return addressToBytes(nft.ownerOf(nodeToId[node]));
		}
	}

	function name(bytes32 node) view public returns (string memory){
		return string(abi.encodePacked(nodeToId[node].toString(), ".", parentLabel, ".eth"));
	}

	function text(bytes32 node, string calldata key) external view returns (string memory) {
		if(keccak256(abi.encodePacked(key)) == keccak256("url")){
			return "www.slackerduckpond.com";
		}
		if(keccak256(abi.encodePacked(key)) == keccak256("avatar")){
			return string(abi.encodePacked("eip155:1/erc721:0xec516efecd8276efc608ecd958a4eab8618c61e8/", nodeToId[node].toString()));
		}
		if(keccak256(abi.encodePacked(key)) == keccak256("description")){
			return "Each Slacker Duck is unique and programmatically generated from over 125 possible assets, such as expression, clothing, and more.";
		}
		if(keccak256(abi.encodePacked(key)) == keccak256("com.discord")){
			return "https://www.slackerduckpond.com/discord";
		}
		if(keccak256(abi.encodePacked(key)) == keccak256("com.twitter")){
			return "SlackerDuckPond";
		}
	}

	function sha3HexAddress(address a) private pure returns (bytes32 ret) {
		a;
		ret;
		assembly {
			let lookup := 0x3031323334353637383961626364656600000000000000000000000000000000

			for { let i := 40 } gt(i, 0) { } {
				i := sub(i, 1)
				mstore8(i, byte(and(a, 0xf), lookup))
				a := div(a, 0x10)
				i := sub(i, 1)
				mstore8(i, byte(and(a, 0xf), lookup))
				a := div(a, 0x10)
			}

			ret := keccak256(0, 40)
		}
	}

	function primary(uint256 tokenId) public view returns (bool) {
		bytes32 label = keccak256(abi.encodePacked(tokenId.toString()));
		bytes32 labelNode = keccak256(abi.encodePacked(parentNode(), label));
		bytes32 reverseNode = keccak256(abi.encodePacked(ADDR_REVERSE_NODE, sha3HexAddress(nft.ownerOf(tokenId))));
		return keccak256(abi.encodePacked(reverseResolver.name(reverseNode))) == keccak256(abi.encodePacked(nodeToId[labelNode].toString(), ".", parentLabel, ".eth"));
	}

	function parentNode() private view returns (bytes32 node) {
		node = 0x0;
		node = keccak256(abi.encodePacked(node, keccak256(abi.encodePacked("eth"))));
		node = keccak256(abi.encodePacked(node, keccak256(abi.encodePacked(parentLabel))));
	}

	function claimSubdomain(uint256 tokenId) public onlyOwner(tokenId) {
		bytes32 label = keccak256(abi.encodePacked(tokenId.toString()));
		bytes32 labelNode = keccak256(abi.encodePacked(parentNode(), label));
		ens.setSubnodeRecord(parentNode(), label, address(this), address(this), 0);
		nodeToId[labelNode] = tokenId;
	}

	modifier onlyOwner(uint256 tokenId) {
		require(nft.ownerOf(tokenId) == msg.sender);
		_;
	}
}

pragma solidity >=0.8.4;

interface ENS {
    // Logged when the owner of a node assigns a new owner to a subnode.
    event NewOwner(bytes32 indexed node, bytes32 indexed label, address owner);

    // Logged when the owner of a node transfers ownership to a new account.
    event Transfer(bytes32 indexed node, address owner);

    // Logged when the resolver for a node changes.
    event NewResolver(bytes32 indexed node, address resolver);

    // Logged when the TTL of a node changes
    event NewTTL(bytes32 indexed node, uint64 ttl);

    // Logged when an operator is added or removed.
    event ApprovalForAll(
        address indexed owner,
        address indexed operator,
        bool approved
    );

    function setRecord(
        bytes32 node,
        address owner,
        address resolver,
        uint64 ttl
    ) external;

    function setSubnodeRecord(
        bytes32 node,
        bytes32 label,
        address owner,
        address resolver,
        uint64 ttl
    ) external;

    function setSubnodeOwner(
        bytes32 node,
        bytes32 label,
        address owner
    ) external returns (bytes32);

    function setResolver(bytes32 node, address resolver) external;

    function setOwner(bytes32 node, address owner) external;

    function setTTL(bytes32 node, uint64 ttl) external;

    function setApprovalForAll(address operator, bool approved) external;

    function owner(bytes32 node) external view returns (address);

    function resolver(bytes32 node) external view returns (address);

    function ttl(bytes32 node) external view returns (uint64);

    function recordExists(bytes32 node) external view returns (bool);

    function isApprovedForAll(address owner, address operator)
        external
        view
        returns (bool);
}

// SPDX-License-Identifier: MIT
// OpenZeppelin Contracts (last updated v4.7.0) (token/ERC721/IERC721.sol)

pragma solidity ^0.8.0;

import "../../utils/introspection/IERC165.sol";

/**
 * @dev Required interface of an ERC721 compliant contract.
 */
interface IERC721 is IERC165 {
    /**
     * @dev Emitted when `tokenId` token is transferred from `from` to `to`.
     */
    event Transfer(address indexed from, address indexed to, uint256 indexed tokenId);

    /**
     * @dev Emitted when `owner` enables `approved` to manage the `tokenId` token.
     */
    event Approval(address indexed owner, address indexed approved, uint256 indexed tokenId);

    /**
     * @dev Emitted when `owner` enables or disables (`approved`) `operator` to manage all of its assets.
     */
    event ApprovalForAll(address indexed owner, address indexed operator, bool approved);

    /**
     * @dev Returns the number of tokens in ``owner``'s account.
     */
    function balanceOf(address owner) external view returns (uint256 balance);

    /**
     * @dev Returns the owner of the `tokenId` token.
     *
     * Requirements:
     *
     * - `tokenId` must exist.
     */
    function ownerOf(uint256 tokenId) external view returns (address owner);

    /**
     * @dev Safely transfers `tokenId` token from `from` to `to`.
     *
     * Requirements:
     *
     * - `from` cannot be the zero address.
     * - `to` cannot be the zero address.
     * - `tokenId` token must exist and be owned by `from`.
     * - If the caller is not `from`, it must be approved to move this token by either {approve} or {setApprovalForAll}.
     * - If `to` refers to a smart contract, it must implement {IERC721Receiver-onERC721Received}, which is called upon a safe transfer.
     *
     * Emits a {Transfer} event.
     */
    function safeTransferFrom(
        address from,
        address to,
        uint256 tokenId,
        bytes calldata data
    ) external;

    /**
     * @dev Safely transfers `tokenId` token from `from` to `to`, checking first that contract recipients
     * are aware of the ERC721 protocol to prevent tokens from being forever locked.
     *
     * Requirements:
     *
     * - `from` cannot be the zero address.
     * - `to` cannot be the zero address.
     * - `tokenId` token must exist and be owned by `from`.
     * - If the caller is not `from`, it must have been allowed to move this token by either {approve} or {setApprovalForAll}.
     * - If `to` refers to a smart contract, it must implement {IERC721Receiver-onERC721Received}, which is called upon a safe transfer.
     *
     * Emits a {Transfer} event.
     */
    function safeTransferFrom(
        address from,
        address to,
        uint256 tokenId
    ) external;

    /**
     * @dev Transfers `tokenId` token from `from` to `to`.
     *
     * WARNING: Usage of this method is discouraged, use {safeTransferFrom} whenever possible.
     *
     * Requirements:
     *
     * - `from` cannot be the zero address.
     * - `to` cannot be the zero address.
     * - `tokenId` token must be owned by `from`.
     * - If the caller is not `from`, it must be approved to move this token by either {approve} or {setApprovalForAll}.
     *
     * Emits a {Transfer} event.
     */
    function transferFrom(
        address from,
        address to,
        uint256 tokenId
    ) external;

    /**
     * @dev Gives permission to `to` to transfer `tokenId` token to another account.
     * The approval is cleared when the token is transferred.
     *
     * Only a single account can be approved at a time, so approving the zero address clears previous approvals.
     *
     * Requirements:
     *
     * - The caller must own the token or be an approved operator.
     * - `tokenId` must exist.
     *
     * Emits an {Approval} event.
     */
    function approve(address to, uint256 tokenId) external;

    /**
     * @dev Approve or remove `operator` as an operator for the caller.
     * Operators can call {transferFrom} or {safeTransferFrom} for any token owned by the caller.
     *
     * Requirements:
     *
     * - The `operator` cannot be the caller.
     *
     * Emits an {ApprovalForAll} event.
     */
    function setApprovalForAll(address operator, bool _approved) external;

    /**
     * @dev Returns the account approved for `tokenId` token.
     *
     * Requirements:
     *
     * - `tokenId` must exist.
     */
    function getApproved(uint256 tokenId) external view returns (address operator);

    /**
     * @dev Returns if the `operator` is allowed to manage all of the assets of `owner`.
     *
     * See {setApprovalForAll}
     */
    function isApprovedForAll(address owner, address operator) external view returns (bool);
}

// SPDX-License-Identifier: MIT
// OpenZeppelin Contracts (last updated v4.7.0) (utils/Strings.sol)

pragma solidity ^0.8.0;

/**
 * @dev String operations.
 */
library Strings {
    bytes16 private constant _HEX_SYMBOLS = "0123456789abcdef";
    uint8 private constant _ADDRESS_LENGTH = 20;

    /**
     * @dev Converts a `uint256` to its ASCII `string` decimal representation.
     */
    function toString(uint256 value) internal pure returns (string memory) {
        // Inspired by OraclizeAPI's implementation - MIT licence
        // https://github.com/oraclize/ethereum-api/blob/b42146b063c7d6ee1358846c198246239e9360e8/oraclizeAPI_0.4.25.sol

        if (value == 0) {
            return "0";
        }
        uint256 temp = value;
        uint256 digits;
        while (temp != 0) {
            digits++;
            temp /= 10;
        }
        bytes memory buffer = new bytes(digits);
        while (value != 0) {
            digits -= 1;
            buffer[digits] = bytes1(uint8(48 + uint256(value % 10)));
            value /= 10;
        }
        return string(buffer);
    }

    /**
     * @dev Converts a `uint256` to its ASCII `string` hexadecimal representation.
     */
    function toHexString(uint256 value) internal pure returns (string memory) {
        if (value == 0) {
            return "0x00";
        }
        uint256 temp = value;
        uint256 length = 0;
        while (temp != 0) {
            length++;
            temp >>= 8;
        }
        return toHexString(value, length);
    }

    /**
     * @dev Converts a `uint256` to its ASCII `string` hexadecimal representation with fixed length.
     */
    function toHexString(uint256 value, uint256 length) internal pure returns (string memory) {
        bytes memory buffer = new bytes(2 * length + 2);
        buffer[0] = "0";
        buffer[1] = "x";
        for (uint256 i = 2 * length + 1; i > 1; --i) {
            buffer[i] = _HEX_SYMBOLS[value & 0xf];
            value >>= 4;
        }
        require(value == 0, "Strings: hex length insufficient");
        return string(buffer);
    }

    /**
     * @dev Converts an `address` with fixed length of 20 bytes to its not checksummed ASCII `string` hexadecimal representation.
     */
    function toHexString(address addr) internal pure returns (string memory) {
        return toHexString(uint256(uint160(addr)), _ADDRESS_LENGTH);
    }
}

// SPDX-License-Identifier: MIT
// OpenZeppelin Contracts v4.4.1 (utils/introspection/IERC165.sol)

pragma solidity ^0.8.0;

/**
 * @dev Interface of the ERC165 standard, as defined in the
 * https://eips.ethereum.org/EIPS/eip-165[EIP].
 *
 * Implementers can declare support of contract interfaces, which can then be
 * queried by others ({ERC165Checker}).
 *
 * For an implementation, see {ERC165}.
 */
interface IERC165 {
    /**
     * @dev Returns true if this contract implements the interface defined by
     * `interfaceId`. See the corresponding
     * https://eips.ethereum.org/EIPS/eip-165#how-interfaces-are-identified[EIP section]
     * to learn more about how these ids are created.
     *
     * This function call must use less than 30 000 gas.
     */
    function supportsInterface(bytes4 interfaceId) external view returns (bool);
}